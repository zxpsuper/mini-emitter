{"version":3,"file":"mini-emitter.es5.js","sources":["../src/mini-emitter.ts"],"sourcesContent":["type CallbackObject = {\r\n    fn: Function,\r\n    ctx: any\r\n}\r\n\r\n/**\r\n * MiniEmitter 事件订阅发布容器\r\n */\r\nexport default class MiniEmitter {\r\n    /**事件集合 */\r\n    private eventMap: Record<string, CallbackObject[]> = {}\r\n    /**\r\n     * 事件订阅\r\n     * @param name 事件名称\r\n     * @param callback 事件回调\r\n     * @param ctx this 上下文\r\n     */\r\n    public on(name: string, callback: Function, ctx: any = null) {\r\n        if (this.eventMap[name] === undefined) {\r\n            this.eventMap[name] = []\r\n        }\r\n        this.eventMap[name].push({\r\n            fn: callback,\r\n            ctx\r\n        })\r\n    }\r\n    /**\r\n     * 事件发布\r\n     * @param name 事件名称\r\n     * @param args 剩余参数\r\n     */\r\n    public emit(name: string, ...args: any[]) {\r\n        if (this.eventMap[name] && this.eventMap[name].length) {\r\n            this.eventMap[name].forEach(obj => {\r\n                obj.fn.apply(obj.ctx, args)\r\n            })\r\n        } else {\r\n            throw Error(`${name} event is not exist!`)\r\n        }\r\n    }\r\n    /**\r\n     * 删除对应的事件，有callback则删除指定事件，没有则删除整个事件名事件\r\n     * @param name 事件名称\r\n     * @param callback 事件回调\r\n     */\r\n    public off(name: string, callback?: Function) {\r\n        if (!callback && this.eventMap[name]) delete this.eventMap[name]\r\n        else {\r\n            if (this.eventMap[name]) {\r\n                this.eventMap[name] = this.eventMap[name].filter(obj => obj.fn !== callback)\r\n            } else {\r\n                throw Error(`${name} event is not exist!`)\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * 执行一次的事件订阅\r\n     * @param name 事件名称\r\n     * @param callback 事件回调\r\n     * @param ctx this 上下文\r\n     * @returns \r\n     */\r\n    public once(name: string, callback: Function, ctx: any = null) {\r\n        const that = this\r\n        function listener() {\r\n            that.off(name, listener)\r\n            callback && callback.apply(ctx, arguments);\r\n        }\r\n        return this.on(name, listener, ctx);\r\n    }\r\n}\r\n\r\n\r\n"],"names":[],"mappings":"AAKA;;;AAGA;IAAA;;QAEY,aAAQ,GAAqC,EAAE,CAAA;KA4D1D;;;;;;;IArDU,wBAAE,GAAT,UAAU,IAAY,EAAE,QAAkB,EAAE,GAAe;QAAf,oBAAA,EAAA,UAAe;QACvD,IAAI,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,SAAS,EAAE;YACnC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,GAAG,EAAE,CAAA;SAC3B;QACD,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC;YACrB,EAAE,EAAE,QAAQ;YACZ,GAAG,KAAA;SACN,CAAC,CAAA;KACL;;;;;;IAMM,0BAAI,GAAX,UAAY,IAAY;QAAE,cAAc;aAAd,UAAc,EAAd,qBAAc,EAAd,IAAc;YAAd,6BAAc;;QACpC,IAAI,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,MAAM,EAAE;YACnD,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,OAAO,CAAC,UAAA,GAAG;gBAC3B,GAAG,CAAC,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,GAAG,EAAE,IAAI,CAAC,CAAA;aAC9B,CAAC,CAAA;SACL;aAAM;YACH,MAAM,KAAK,CAAC,UAAG,IAAI,yBAAsB,CAAC,CAAA;SAC7C;KACJ;;;;;;IAMM,yBAAG,GAAV,UAAW,IAAY,EAAE,QAAmB;QACxC,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC;YAAE,OAAO,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAA;aAC3D;YACD,IAAI,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE;gBACrB,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,MAAM,CAAC,UAAA,GAAG,IAAI,OAAA,GAAG,CAAC,EAAE,KAAK,QAAQ,GAAA,CAAC,CAAA;aAC/E;iBAAM;gBACH,MAAM,KAAK,CAAC,UAAG,IAAI,yBAAsB,CAAC,CAAA;aAC7C;SACJ;KACJ;;;;;;;;IAQM,0BAAI,GAAX,UAAY,IAAY,EAAE,QAAkB,EAAE,GAAe;QAAf,oBAAA,EAAA,UAAe;QACzD,IAAM,IAAI,GAAG,IAAI,CAAA;QACjB,SAAS,QAAQ;YACb,IAAI,CAAC,GAAG,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAA;YACxB,QAAQ,IAAI,QAAQ,CAAC,KAAK,CAAC,GAAG,EAAE,SAAS,CAAC,CAAC;SAC9C;QACD,OAAO,IAAI,CAAC,EAAE,CAAC,IAAI,EAAE,QAAQ,EAAE,GAAG,CAAC,CAAC;KACvC;IACL,kBAAC;CAAA,IAAA;;;;"}