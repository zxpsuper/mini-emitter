{"version":3,"file":"mini-emitter.umd.js","sources":["../src/mini-emitter.ts"],"sourcesContent":["type CallbackObject = {\r\n    fn: Function,\r\n    ctx: any\r\n}\r\n\r\n/**\r\n * MiniEmitter 事件订阅发布容器\r\n */\r\nexport default class MiniEmitter {\r\n    /**事件集合 */\r\n    private eventMap: Record<string, CallbackObject[]> = {}\r\n    /**\r\n     * 事件订阅\r\n     * @param name 事件名称\r\n     * @param callback 事件回调\r\n     * @param ctx this 上下文\r\n     */\r\n    public on(name: string, callback: Function, ctx: any = null) {\r\n        if (this.eventMap[name] === undefined) {\r\n            this.eventMap[name] = []\r\n        }\r\n        this.eventMap[name].push({\r\n            fn: callback,\r\n            ctx\r\n        })\r\n    }\r\n    /**\r\n     * 事件发布\r\n     * @param name 事件名称\r\n     * @param args 剩余参数\r\n     */\r\n    public emit(name: string, ...args: any[]) {\r\n        if (this.eventMap[name] && this.eventMap[name].length) {\r\n            this.eventMap[name].forEach(obj => {\r\n                obj.fn.apply(obj.ctx, args)\r\n            })\r\n        } else {\r\n            throw Error(`${name} event is not exist!`)\r\n        }\r\n    }\r\n    /**\r\n     * 删除对应的事件，有callback则删除指定事件，没有则删除整个事件名事件\r\n     * @param name 事件名称\r\n     * @param callback 事件回调\r\n     */\r\n    public off(name: string, callback?: Function) {\r\n        if (!callback && this.eventMap[name]) delete this.eventMap[name]\r\n        else {\r\n            if (this.eventMap[name]) {\r\n                this.eventMap[name] = this.eventMap[name].filter(obj => obj.fn !== callback)\r\n            } else {\r\n                throw Error(`${name} event is not exist!`)\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * 执行一次的事件订阅\r\n     * @param name 事件名称\r\n     * @param callback 事件回调\r\n     * @param ctx this 上下文\r\n     * @returns \r\n     */\r\n    public once(name: string, callback: Function, ctx: any = null) {\r\n        const that = this\r\n        function listener() {\r\n            that.off(name, listener)\r\n            callback && callback.apply(ctx, arguments);\r\n        }\r\n        return this.on(name, listener, ctx);\r\n    }\r\n}\r\n\r\n\r\n"],"names":[],"mappings":";;;;;;IAKA;;;IAGA;QAAA;;YAEY,aAAQ,GAAqC,EAAE,CAAA;SA4D1D;;;;;;;QArDU,wBAAE,GAAT,UAAU,IAAY,EAAE,QAAkB,EAAE,GAAe;YAAf,oBAAA,EAAA,UAAe;YACvD,IAAI,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,SAAS,EAAE;gBACnC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,GAAG,EAAE,CAAA;aAC3B;YACD,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC;gBACrB,EAAE,EAAE,QAAQ;gBACZ,GAAG,KAAA;aACN,CAAC,CAAA;SACL;;;;;;QAMM,0BAAI,GAAX,UAAY,IAAY;YAAE,cAAc;iBAAd,UAAc,EAAd,qBAAc,EAAd,IAAc;gBAAd,6BAAc;;YACpC,IAAI,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,MAAM,EAAE;gBACnD,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,OAAO,CAAC,UAAA,GAAG;oBAC3B,GAAG,CAAC,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,GAAG,EAAE,IAAI,CAAC,CAAA;iBAC9B,CAAC,CAAA;aACL;iBAAM;gBACH,MAAM,KAAK,CAAC,UAAG,IAAI,yBAAsB,CAAC,CAAA;aAC7C;SACJ;;;;;;QAMM,yBAAG,GAAV,UAAW,IAAY,EAAE,QAAmB;YACxC,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC;gBAAE,OAAO,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAA;iBAC3D;gBACD,IAAI,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE;oBACrB,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,MAAM,CAAC,UAAA,GAAG,IAAI,OAAA,GAAG,CAAC,EAAE,KAAK,QAAQ,GAAA,CAAC,CAAA;iBAC/E;qBAAM;oBACH,MAAM,KAAK,CAAC,UAAG,IAAI,yBAAsB,CAAC,CAAA;iBAC7C;aACJ;SACJ;;;;;;;;QAQM,0BAAI,GAAX,UAAY,IAAY,EAAE,QAAkB,EAAE,GAAe;YAAf,oBAAA,EAAA,UAAe;YACzD,IAAM,IAAI,GAAG,IAAI,CAAA;YACjB,SAAS,QAAQ;gBACb,IAAI,CAAC,GAAG,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAA;gBACxB,QAAQ,IAAI,QAAQ,CAAC,KAAK,CAAC,GAAG,EAAE,SAAS,CAAC,CAAC;aAC9C;YACD,OAAO,IAAI,CAAC,EAAE,CAAC,IAAI,EAAE,QAAQ,EAAE,GAAG,CAAC,CAAC;SACvC;QACL,kBAAC;IAAD,CAAC,IAAA;;;;;;;;"}